---
layout: post
title: Криптозащита паролей
date: 2015-06-21
category: passwords
tags: [bcrypt, blowfish, md5]
canonical: https://securemywp.ru/2015/06/21/криптозащита-паролей/
---

В вордпрессе, как и во многих современных веб-приложениях, используется довольно устаревшая система обращения с паролями. **В двух словах**, когда пользователь вводит пароль (например, чтобы из посетителя стать автором блога, администратором сайта или идентифицированным клиентом), на сервере с ним производится одностороннее преобразование, вычисляется хэш, который и сравнивается с предварительно сохраненным. Сейчас в большинстве случаев, в том числе и в вордпрессе, для вычисления хэша используется алгоритм [md5](https://ru.wikipedia.org/wiki/MD5).

Проблема в том, что, с одной стороны, за последние годы чрезвычайно выросла мощность вычислительных систем, в том числе и домашних компьютеров, с другой стороны, стали более продвинутыми и изощренными алгоритмы взлома. Задача, узнав хэш, вычисленный по алгоритму <code>md5</code>, восстановить пароль, из которого он образован, стала гораздо более доступной рядовому злоумышленнику.

Для решения этой проблемы требуется смена алгоритма шифрования пароля. Используя вместо <code>md5</code> хэш-функцию [bcrypt](https://en.wikipedia.org/wiki/Bcrypt), основанную на алгоритме [blowfish](https://ru.wikipedia.org/wiki/Blowfish), можно кардинально усложнить задачу злоумышленнику по восстановлению пароля из хэша. Требуемые вычисления при этом усложнятся до неприемлемо долгих, когда попытки восстановить пароль полностью теряют смысл (чего, к сожалению, сейчас нельзя сказать об алгоритме <code>md5</code>).

Практически задача смены алгоритма шифрования паролей решается, как обычно, соответствующим плагином, после установки которого для вычисления хэшей вместо <code>md5</code> будет использоваться <code>bcrypt</code> с регулируемой сложностью. Как и прежде, мы пока воздерживаемся от рекомендации конкретных плагинов.
