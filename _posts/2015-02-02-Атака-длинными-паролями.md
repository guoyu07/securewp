---
layout: post
title: Атака длинными паролями
date: 2015-02-02
category: core
tags: [Apache, Denial of Service, DOS, hash, md5, MySQL]
canonical: https://securemywp.ru/2015/02/02/атака-длинными-паролями/
---

Весьма забавная уязвимость. Тип уязвимости `DOS (Denial of Service)`. Действовала вплоть до версии 4.0, устранена в версии 4.0.1 путем ограничения длины обрабатываемого пароля до 4 Кб.

До устранения этой уязвимости вводимые при входе в админпанель пароли не ограничивались по длине. При этом введенный пароль обрабатывается, если имя пользователя существует, сервер должен вычислить хеш каждого введенного пароля. Если атакующий вводил на регулярной основе длинные пароли, это вызывало перегрузку серверного процессора. Если для существующего пользователя ввести пароль в виде строки из миллиона символов ‘a’, и так много раз, сервер можно изрядно загрузить. Заметим, что, например, апач будет держать соединение и ждать, пока php закончит вычисление хеша. То есть, процессор будет занят вычислением хеша, память будет занята экземпляром апача, сеть активным соединением. В связи с этим при атаке возможно исчерпание ресурсов оперативной памяти и свопа и падение веб-сервера и сервера `MySQL`. Если даже сервер, благодаря правильной настройке, не упадет, легко может быть исчерпан ресурс сетевых сокетов.

Эту же уязвимость можно было использовать для выявления пользователей вордпресса. Поскольку для несуществующего пользователя хеш не вычисляется, то время отклика при вводе пароля длиной миллион символов будет заметно отличаться.

[Подробности](http://www.behindthefirewalls.com/2014/11/wordpress-denial-of-service-responsible-disclosure.html)…
