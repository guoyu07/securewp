---
layout: post
title: Продолжение панамской революции
date: 2016-04-14
category: infosec
tags: [Mossack Fonseca, Panama, Panama Papers leaks, PanamaGate, panamapapers, php, Revolution, upload_plugin, Wordpress, zip, Панамский скандал, Панамское досье]
canonical: https://securemywp.ru/2016/04/14/продолжение-панамской-революции/
---

Итак, технически масштабная утечка документов с серверов панамской юридической компании **Mossack Fonseca** произошла, скорее всего, через шелл, залитый на сервер через [уязвимый вордпресс-плагин *Revolution Slider*](https://securemywp.ru/2016/04/11/панамском-деле-не-обошлось-без-револ/).

Информация об этой уязвимости [была опубликована](https://www.exploit-db.com/exploits/35385/) в ноябре 2014 года. Заметим, что как только появляется информация о такой уязвимости, роботы злоумышленников немедленно начинают сканировать вордпресс-сайты на предмет файла (в данном случае) <code>/wp-content/plugins/revslider/release_log.txt</code>. Нет сомнений, что среди множества таких сайтов найдется множество, не обновившихся во-время. Остается лишь отсеять представляющие хоть какой-то интерес.

Если же сайт, как в нашем случае, заведомо может быть мишенью для проникновения, поскольку наверняка содержит чувствительную информацию, в первую очередь приватные данные клиентов, остается лишь дождаться подходящего случая, что, видимо, и произошло.

Итак, уязвимая версия плагина (вплоть до 3.0.95) содержит метод <code>upload_plugin</code>, позволяющий неавторизованному пользователю залить во временную директорию плагина zip-файл с исполняемым php-кодом. Скорее всего, авторы предполагали такую возможность лишь для привелигированного пользователя, но, как часто бывает, потом об этом забыли.

Вот видео, демонстрирующее, как можно воспользоваться этой уязвимостью:

<iframe src="https://player.vimeo.com/video/161966079" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>

[![IMAGE ALT TEXT HERE]()](https://player.vimeo.com/video/161966079)


Есть информация, что компанию *Mossack Fonseca* предупреждали о наличии на ее вордпресс-сайте устаревшего плагина с уязвимостью. Однако, плагин продолжал оставаться не обновленным уже и спустя некоторое время после скандала, и лишь совсем недавно (в начале апреля с.г.) плагин был полностью уделен.

[И это еще не все, будет больше](http://securemywp.ru/2016/04/15/взлом-и-утечка-данных-не-одно/)…

…[вся ветка]().

Кстати, если вас заботит безопасность вашего вордпресс-сайта, [пишите нам](https://rifco.ru/contact/).
